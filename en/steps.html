<!DOCTYPE html>
<html class="no-js" lang="en">
 
	
<!-- header::Start -->
	<head>
		<!-- Use Internet Explorer 9 Standards mode for Eclipse Browser Control - https://www.eclipse.org/swt/faq.php#browsernativeie and https://msdn.microsoft.com/en-us/library/jj676915%28v=vs.85%29.aspx -->
  		<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
		
		<!-- Next 2 http=equiv headers required to disable caching the Eclipse Browser Widget -->
		<meta http-equiv="Pragma" content="no-cache">
  		<meta http-equiv="Expires" content="-1">

		<meta charset="UTF-8"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<meta name="copyright" content="Copyright IBM Corporation 2014" />
		<meta name="abstract" content="IBM App Connect Enterprise V11 Tutorial">
		<meta name="author" content="IBM">
		<meta name="description" content="IBM App Connect Enterprise V11 Tutorial">
		<meta name="keywords" content="keywords" > 
		<meta name="robots" content="index,follow">
		<meta name="source" content="IBM App Connect Enterprise V11 Tutorial" /> 
		
		<title>IBM App Connect Enterprise V11 Tutorial</title>

    	<link rel="stylesheet" href="https://ot4i.github.io/iib-tutorials/css/main.css" />
		<link rel="stylesheet" href="https://ot4i.github.io/iib-tutorials/css/app.css" />
    	
		<script src="https://ot4i.github.io/iib-tutorials/js/json2.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/js2java.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/js2java_steps.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/vendor/modernizr.js"></script>
	</head>
<!-- header::End -->
<!-- body::Start -->
		<body>
  	<!-- body content here -->
	<div class="row">
	  <div class="small-12 medium-12 large-12 columns">
	    <p> </p>
	  </div>
	</div>
	<div class="row">
	  <div class="small-9 medium-9 large-9 columns">
	    <h4 class="title">Getting started with ACEv11 - Policy Projects and Policies with Overrides <action><button class="small radius button" tabindex="0" id="stepsViewDetails" onclick="viewDetails()"> View Details</button> </action></h4>
	  </div>
	  <div class="small-3 medium-3 large-3 columns">
		<a href="javascript:;" onclick="openExternalBrowser('https://www.ibm.com/support/knowledgecenter/en/SSTTDS_11.0.0/com.ibm.ace.home.doc/help_home.htm')" class="small right helplink">IBM Knowledge Center</a> 
	  </div>
	</div> 
	<hr>
	<div class="row">
		<div class="small-10 medium-10 large-10 columns">
		<h5> Learn about configuring ACE behavior using Policies and the hierarchy of policy overrides </h5>
		</div>
		<div class="small-2 medium-2 large-2 columns">
			<button class="small radius button right" tabindex="0" id="backToGallery" onclick="backToGallery()"> Back To Gallery
			</button>
		</div>
	</div>
	<div class="row">          
		  <div class="small-12 medium-12 large-12 columns">
			<ul class="tabs vertical"> 
				<li class="tab-title tab-title-small active">
				  <a href="javascript:;" onclick="show('panel21')">Create</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel31')">Prepare</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel41')">Run</a> 
				</li>
			</ul>
			<!-- editing -->
			<div class="tabs-content panel-thin-blue vertical"> 
		    	<div class="content active" id="panel21">
		    		
		    		<div class="small-10 medium-10 large-10 columns divider">
					
				      	<div class="row content-details">
					      	<h4>Import an application and create a policy project with an SMTP policy</h4>
					        
						    
								<p>  </p>
								
								
									
									<ol>
									
									
										<li> Click  <span class="uicontrol">Import</span> and the <span class="uicontrol">HTTPInputEmailOutput</span> application will be imported into your workspace.
										
										</li>
									
										<li> Open the HTTPInputEmailOutput message flow and look at the EmailOutput node's properties. Note that the Basic property tab has a property named <span class="uicontrol">SMTP Server and Port</span> which addresses <code>{MyPolicyProject}:MySMTPPolicy</code>
										
										</li>
									
										<li> On the Email property tab, note that the property named <span class="uicontrol">To Addresses</span> specifies a value of <code>anyobscurenameyouwant@mailinator.com</code>. You can optionally change this if you want. This is the email address to which an email will be sent (from your SMTP email provider)
										
										</li>
									
										<li> On the Email property tab, change the property named <span class="uicontrol">From Address</span> to be your email address from which you intend the email to be sent (when ACE connects to your SMTP server)
										
										</li>
									
										<li> Create a Policy project named <span class="uicontrol">MyPolicyProject</span> using the New link in the top right corner of the Application Development view.
										
										</li>
									
										<li> Create a Policy named <span class="uicontrol">MySMTPPolicy</span> of type SMTP (click the New link which appeared inside the empty project you just created).  Set the <span class="uicontrol">SMTP server name</span> to be your SMTP server. For example, smtp.hursley.ibm.com:25 Set the <span class="uicontrol">Security identity</span> to be the hardcoded string <code>GoodIdentity</code> (this value will be mapped to your actual identity using the mqsisetdbparms command in the later steps)
										
										</li>
									
									
									</ol>
									
								
							
						</div>
						
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="importArtifacts(); openResource('SimpleFlow')"> Import <img class="icon-image" src="https://ot4i.github.io/iib-tutorials/images/icons/ibmdesign/back-right-previous_128-orange.png"></a></h4>
										
				    </div>
					
		    	</div>
		    	<div class="content" id="panel31">
					
					<div class="small-12 medium-12 large-12 columns">
					
						<div class="row content-details">
						  	<h4>Create and Configure an Integration Server</h4>
						    
						    
								<p>  </p>
								
								
									
									<ol>
									
									
										<li> Open an App Connect Enterprise Command Console and run the mqsicreateworkdir command to prepare a work directory for an integration server:<br><ul><li>If you are using a Windows platform: <code>mqsicreateworkdir C:\MyServer</code></li><li>If you are using a UNIX platform: <code>mqsicreateworkdir /home/exampleuser/MyServer</code></li></ul>
										
										</li>
									
										<li> Run the mqsisetdbparms command to define the identity which ACE will use when communicating with your SMTP server:<br><ul><li>If you are using a Windows platform: <code>mqsisetdbparms -w C:\MyServer -n smtp::GoodIdentity -u YourSMTPUserId -p YourSMTPPassword</code><br>where <b>C:\MyServer</b> is a folder on your file system, created in the command above, that the server will use for its working directory.</li><li>If you are using a UNIX platform: <code>mqsisetdbparms -w /home/exampleuser/MyServer -n smtp::GoodIdentity -u YourSMTPUserId -p YourSMTPPassword</code><br>where <b>/home/exampleuser/MyServer</b> is a folder on your file system, created in the command above, that the server will use for its working directory.</li></ul>
										
										</li>
									
										<li> Now, start the integration server using the following command:<br><ul><li>If you are using a Windows platform: <code>IntegrationServer --work-dir C:\MyServer --name MyServer --admin-rest-api 7600 --http-port-number 7900 --console-log</code></li><li>If you are using a UNIX platform: <code>IntegrationServer --work-dir /home/exampleuser/MyServer --name MyServer --admin-rest-api 7600 --http-port-number 7900 --console-log</code></li></ul>
										
										</li>
									
										<li> After a few seconds the server should report that it has finished initialization and that its HTTP Listener has started listening for connections.
										
										</li>
									
									
									</ol>
									
								
							
						</div>
							
					</div>
					
		    	</div>
		    	<div class="content" id="panel41">
		    		
					<div class="small-12 medium-12 large-12 columns">
					
				    	<div class="row content-details">
					      	<h4>Run three separate examples to demonstrate policy identification and overrides</h4>
					        
						    
								<p> <b>Learn how the {PolicyProject}:Policy syntax can address a deployed policy</b> </p>
								
								
									
									<ol>
									
									
										<li> In the App Connect Enterprise Toolkit, connect to your Integration Server <span class="uicontrol">MyServer</span> on localhost:7600. Create a Broker Archive file, for example named <span class="uicontrol">HTTPInputEmailOutput.bar</span> inside the <span class="uicontrol">HTTPInputEmailOutput</span> application project which you imported earlier.  Once you have created the BAR file, you need to add to it both the <span class="uicontrol">HTTPInputEmailOutput</span> application and the <span class="uicontrol">MyPolicyProject</span> policy project. Remember to click the <span class="uicontrol">Build and Save</span> button on the BAR editor's prepare tab.
										
										</li>
									
										<li> Drag and drop deploy the <span class="uicontrol">HTTPInputEmailOutput.bar</span> BAR file onto <span class="uicontrol">MyServer</span>.
										
										</li>
									
										<li> Test the message flow by sending HTTP data to it using a client such as cURL: <br><code>curl -X POST http://localhost:7900/HTTPInputEmailOutput -d HelloWorld</code><br>
										
										</li>
									
										<li> The message flow should echo back the same message to the HTTP client, but you should find that the flow's email Output node has successfully found the SMTP policy you deployed, which in turn used the abstracted userid and password which was defined using mqsisetdbparms, and an email will have been successfully sent. Check this is the case. If you are using mailinator for this purpose, you can open the public mailbox using a web browser and a URL like this:<br><code>http://www.mailinator.com/v2/inbox.jsp?zone=public&query=anyobscurenameyouwant</code>
										
										</li>
									
									
									</ol>
									
								
							
								<p> <b>Learn how unqualified policy names won't be resolved, if you haven't defined a default policy project</b> </p>
								
								
									
									<ol>
									
									
										<li> Delete all resources which have previously been deployed. Open the HTTPInputEmailOutput message flow and on the EmailOutput node's Basic property tab edit the property named <span class="uicontrol">SMTP Server and Port</span> to take the value <code>MySMTPPolicy</code> (so it is no longer qualified by the name of the policy project).
										
										</li>
									
										<li> Open the  <span class="uicontrol">HTTPInputEmailOutput.bar</span> BAR file and click the <span class="uicontrol">Build and Save</span> button on the BAR editor's prepare tab. Drag and drop deploy the updated BAR file.
										
										</li>
									
										<li> Repeat the test of the message flow by sending HTTP data to it using a client such as cURL, and this time you will note that an exception is reported in the command console window where the IntegrationServer is running. This exception occurs because having deleted the Policy Project qualifier, the EmailOutput node's policy can no longer be located.
										
										</li>
									
									
									</ol>
									
								
							
								<p> <b>Learn how unqualified policy names will be resolved, if you have defined a default policy project</b> </p>
								
								
									
									<ol>
									
									
										<li> Delete all resources which have previously been deployed and then stop the Integration Server using CTRL-C in the command console window where it is running.
										
										</li>
									
										<li> Look inside your integration server's work directory on the file system (at <code>C:\MyServer</code> on Windows and at <code>/home/exampleuser/MyServer</code> on UNIX) and edit the <code>server.conf.yaml</code> file. Find this line:<br><code>  #policyProject: 'DefaultPolicies'   # Name of the Policy project that will be used for unqualified Policy references</code><br>... and change it to become ...<br><code>  policyProject: 'MyPolicyProject'   # Name of the Policy project that will be used for unqualified Policy references </code>
										
										</li>
									
										<li> From your App Connect Enterprise Toolkit's workspace directory on the file system, copy the <code>MyPolicyProject</code> project (which is a directory on your file system) into your Integration Server's overrides directory. If you have followed this tutorial's suggested naming conventions then this directory will end up at <code>C:\MyTestServer\overrides\MyPolicyProject</code> on Windows and at <code>/home/exampleuser/MyServer/overrides/MyPolicyProject</code> on UNIX. Restart your integration server.
										
										</li>
									
										<li> Back in the App Connect Enterprise Toolkit, create a new BAR file, for example named  <span class="uicontrol">HTTPInputEmailOutput2.bar</span>, and build it to <strong>just</strong> contain the application <span class="uicontrol">HTTPInputEmailOutput</span> and NOT the policy project   <span class="uicontrol">MyPolicyProject</span>. Deploy the new BAR file.
										
										</li>
									
										<li> Retest the message flow using cURL just as you have done before and note that it will now send the email again successfully. This has demonstrated the fact that on message flow node properties, App Connect Enterprise will look for unqualified policies in the default policy project which you can configure for your server using the server.conf.yaml file.
										
										</li>
									
									
									</ol>
									
								
							
						</div>
							
					</div>
					
				</div>	
			</div> <!-- tab-content -->
		</div> <!-- columns -->
	  </div> <!-- row --></body>
		<script src="https://ot4i.github.io/iib-tutorials/js/vendor/jquery.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/vendor/foundation.min.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/main.js"></script>
	</body>
<!-- body::End -->

</html>